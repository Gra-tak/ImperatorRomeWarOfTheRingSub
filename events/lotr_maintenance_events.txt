namespace = lotr_maintenance

#Various maintenance events

		
lotr_maintenance.1 = { 
	
	type = country_event
  title = "lotr_maintenance.1.t"
  desc = "lotr_maintenance.1.desc"
  picture = event_orcs_orcs

	trigger = {
    country_culture_group  = orcs_group
    war = no
    any_unit = {
      has_variable = displaced_orcs
    }
	}
	
	immediate = {
	}
	
	option = {
		name = "OK"	
    set_variable = {
      name = num_orcs
      value = 0
    }
    every_unit = {
      limit = {
        has_variable = displaced_orcs
      }
      every_sub_unit = {
        ROOT = {
          change_variable = {
            name = num_orcs
            add = 1
          }
        }
      }
      destroy_unit = yes
    }
    while = {
      limit = { var:num_orcs > 3 }
      random_owned_province = {
        limit = {
          total_population < population_cap
        }
        define_pop = {
          type = slaves
          culture = root.culture
          religion = root.religion
        }
      }
      change_variable = {
        name = num_orcs
        subtract = 6
      }
    }
    ai_chance = {
      base = 100
    }
	}
  option = {
    name = "lotr_maintenance.1.b" 
    ai_chance = {
      base = 0
    }
  }
}


#pseudo diloyal vassals in civil wars
lotr_maintenance.2 = { 
  type = country_event
  hidden = yes
  trigger = {
    OR = {
      tag = GON
      tag = CAR
      tag = ARN
    }
    has_civil_war = yes
  }
  immediate = {
    every_current_war = {
      limit = { is_civil_war = yes }
      every_war_participant = {
        limit = {
          OR = {
            is_subject_type = satrapy
            is_subject_type = ranger_protectorate
          }
        }
        add_to_list = fighting_subjects
        PREV = {
          remove_from_war = PREV.PREV
        }
      }
    }
    every_in_list = {
      list = fighting_subjects
      overlord = { release_subject = PREV }
      ROOT = {
        if = { 
          limit = { THIS = c:GON }
          make_subject = {
            target = PREV
            type = satrapy
          }
        }
        else
        {
          make_subject = {
            target = PREV
            type = ranger_protectorate
          }
        }
      }
    }
  }
}

#accept cultures for AI (somehow they seem to fail to use the cultural decision)
lotr_maintenance.3 = { 
  type = country_event
  hidden = yes
  trigger = {
    is_ai = yes
  }
  immediate = {
    every_country_culture = {
      limit = {
        is_integrated = no
        culture.culture_group = ROOT.country_culture_group
        is_large_culture = yes
      }
      ROOT = { integrate_country_culture = PREV }
    }
  }
}

#mark provinces near orcs for raids.
lotr_maintenance.4 = { 
  type = country_event
  hidden = yes
  trigger = {
    is_ai = no
  }
  immediate = {
    every_region = {
      limit = {
        any_region_province = {
          has_owner = yes
          owner = {
            primary_culture = goblins
          }
        }
      }
      every_region_province = {
        limit = {
          OR = {
            has_owner = no
            owner = { religion = melkorism }
          }
        }
        set_variable = {
          name = hasGoblinsRaidsFlag
          days = 365
        }
      }
    }
    every_region = {
      limit = {
        any_region_province = {
          has_owner = yes
          owner = {
            primary_culture = orcish
          }
        }
      }
      every_region_province = {
        limit = {
          OR = {
            has_owner = no
            owner = { religion = melkorism }
          }
        }
        set_variable = {
          name = hasOrcRaidsFlag
          days = 365
        }
      }
    }
    every_region = {
      limit = {
        any_region_province = {
          has_owner = yes
          owner = {
            primary_culture = urukhai
          }
        }
      }
      every_region_province = {
        limit = {
          OR = {
            has_owner = no
            owner = { religion = melkorism }
          }
        }
        set_variable = {
          name = hasUrukRaidsFlag
          days = 365
        }
      }
    every_country = {
      limit = {
        NOT = { religion = melkorism }
        is_ai = no
      }
      set_variable = {
        name = golbin_raid_province_num
        value = country_count_possibly_raided_provinces_goblins
      }
      set_variable = {
        name = orc_raid_province_num
        value = country_count_possibly_raided_provinces_orcs
      }
      set_variable = {
        name = uruk_raid_province_num
        value = country_count_possibly_raided_provinces_uruk
      }
    }
  }
}
